<%CFG_MAP(lan_ip,LAN_IP);%><%CFG_MAP(lan_mask,LAN_MSK);%><%CFG_MAP(lan_gw,LAN_GW);%><%CFG_MAP(lan_mac,HW_LAN_MAC);%><%CFG_MAP(dhcp_enable,LAN_DHCPD_EN);%><%CFG_MAP(dhcp_startip,LAN_DHCPD_START);%><%CFG_MAP(dhcp_endip,LAN_DHCPD_END);%><%CFG_MAP(leasetime,LAN_DHCPD_LEASET);%><%CFG_MAP(domain_name,LAN_DHCPD_DOMAIN);%><%CFG_MAP(lan_chg,LAN_CHANGE);%>var def_lanip="<%CFG_GET(STS_LAN_DEF_IP);%>";<%CFG_MAP(u_wan_type,WAN_TYPE);%><%CFG_MAP(u_wan_mac,HW_WAN_MAC);%><%CFG_MAP(u_wan_ip,STS_WAN_IP);%><%CFG_MAP(u_wan_msk,STS_WAN_MSK);%><%CFG_MAP(u_wan_gw,STS_WAN_GW);%><%CFG_MAP(u_wan_dns,STS_WAN_DNS);%>function set_guest_wifi_authcfg(_mod,_key)
{var sc_mod=0;var i=0;switch(_mod)
{case 3:default:setCfg("wifi_guest_authmode","OPEN");setCfg("wifi_guest_encryptype","NONE");break;case 2:setCfg("wifi_guest_authmode",'WEPAUTO');setCfg("wifi_guest_encryptype",'WEP');if(_key.length==26){setCfg("wifi_guest_wep_keyidx",'1');setCfg("wifi_guest_wep_key"+"1",_key);for(i=2;i<=4;i++){setCfg("wifi_guest_wep_key"+i,'');}}else{var cut=0;setCfg("wifi_guest_wep_keyidx",'1');for(i=1;i<=4;i++){cut=(i-1)*10;setCfg("wifi_guest_wep_key"+i,_key.substring(cut,cut+10));}}
break;case 1:var wpa_mod=parseInt(3,10);if(parseInt(1,10)==1){if(wpa_mod==1)
setCfg("wifi_guest_authmode","WPAPSK");else if(wpa_mod==2)
setCfg("wifi_guest_authmode","WPA2PSK");else
setCfg("wifi_guest_authmode","WPAPSKWPA2PSK");}else{if(wpa_mod==1)
setCfg("wifi_guest_authmode","WPA");else if(wpa_mod==2)
setCfg("wifi_guest_authmode","WPA2");else
setCfg("wifi_guest_authmode","WPAWPA2");}
setCfg("wifi_guest_encryptype","TKIPAES");setCfg("wifi_guest_wpa_key",_key);}}<%CFG_MAP(guest_en,WIFI_GUEST_EN);%><%CFG_MAP(guest_mode,WIFI_GUEST_TYPE);%><%CFG_MAP(guest_ssid,WIFI_GUEST_SSID);%><%CFG_MAP(guest_wep,WIFI_GUEST_WEP);%><%CFG_MAP(guest_psk,WIFI_GUEST_PASWD);%><%CFG_MAP(wifi_guest_authmode,WIFI_GUEST_AUTHMODE);%><%CFG_MAP(wifi_guest_encryptype,WIFI_GUEST_ENCRYPTYPE);%><%CFG_MAP(wifi_guest_wep_keyidx,WIFI_GUEST_KEYIDX);%><%CFG_MAP_ARY(wifi_guest_wep_key,WIFI_GUEST_WEP_KEY,4,1);%><%CFG_MAP(wifi_guest_wpa_key,WIFI_GUEST_WPA_KEY);%>var SSID_ChkSpecialChar=0;<%CFG_MAP(wlan_ssid,WIFI_SSID);%><%CFG_MAP(wlan_en,WIFI_EN);%><%CFG_MAP(wlan_authmode,WIFI_AUTHMODE);%><%CFG_MAP_ARY(wlan_wep_key,WIFI_WEP_KEY,4,1);%><%CFG_MAP_ARY(wlan_wpa_key,WIFI_WPA_KEY,4,1);%><%CFG_MAP(wlan_ssid1,WIFI_5G_SSID);%><%CFG_MAP(wlan_en1,WIFI_EN+1);%><%CFG_MAP(wlan_authmode1,WIFI_5G_AUTHMODE);%><%CFG_MAP_ARY(wlan_wep_key1,WIFI_5G_WEP_KEY,4,1);%><%CFG_MAP_ARY(wlan_wpa_key1,WIFI_5G_WPA_KEY,4,1);%><%CFG_MAP(wlan_g_ssid,WIFI_GUEST_SSID);%><%CFG_MAP(wlan_g_en,WIFI_GUEST_EN);%><%CFG_MAP(wlan_g_mode,WIFI_GUEST_TYPE);%><%CFG_MAP(wlan_g_wep,WIFI_GUEST_WEP);%><%CFG_MAP(wlan_g_psk,WIFI_GUEST_PASWD);%>function getWLANInfo(){var k,i;for(var i=0;i<=WIFI_BAND;i++){k=((i==0)?'':i);G_ssid[i]=getCfg("wlan_ssid"+k);G_en[i]=getCfgInt("wlan_en"+k);var auth=getCfg("wlan_authmode"+k);if(auth=='OPEN'){G_key[i]='';}else if(auth=='WEPAUTO'){G_key[i]=getCfg("wlan_wep_key1"+k);}else{G_key[i]=getCfg("wlan_wpa_key1"+k);}
G_sc[i]=getWLAN_sc(i);}
var _mode=getCfg("wlan_g_mode");var _key="";G_ssid[2]=getCfg("wlan_g_ssid");G_en[2]=getCfgInt("wlan_g_en");if(_mode=='2'){G_key[2]=getCfg("wlan_g_wep");G_sc[2]=getWALN_SecStr(1);}else if(_mode=='0'||_mode=='1'){G_key[2]=getCfg("wlan_g_psk");G_sc[2]=getWALN_SecStr(5);}else{G_key[2]="";G_sc[2]=getWALN_SecStr(0);}}
function show_wrapKey(key){var s="";var len=Math.ceil(key.length/32)+1;for(var i=0;i<len;i++){s+=key.substr(i*32,32);if(i!=len-1)s+='<br>';}
return s;}
function getWALN_SecStr(sc_mod){var wifi_sc_s={0:'318',1:'64bit WEP',2:'128bit WEP',3:'WPA-PSK',4:'WPA2-PSK',5:'WPA/WPA2-Personal (PSK)',6:'WPA',7:'WPA2',8:'1297'};return getLangC(wifi_sc_s[sc_mod]);}
function getWLAN_sc(idx){var sc_mod=0;var k=((idx==0)?'':idx);var auth=getCfg("wlan_authmode"+k);if(auth=='OPEN')
sc_mod=0;else if(auth=='WEPAUTO'){sc_mod=2;if(parseInt(getCfg("wifi_wep_keylen"+k),10)==10)
sc_mod=1;}else if(auth=='WPAPSK')
sc_mod=3;else if(auth=='WPA2PSK')
sc_mod=4;else if(auth=='WPAPSKWPA2PSK')
sc_mod=5;else if(auth=='WPA')
sc_mod=6;else if(auth=='WPA2')
sc_mod=7;else if(auth=='WPAWPA2')
sc_mod=8;return getWALN_SecStr(sc_mod);}
var ui_wep_4_key=1;ui_wep_4_key=0;var DUAL_WL_DESC=0;var DUAL_WL_BAND=1;var DUAL_WL_RATE=2;var DUAL_WL_CHAN=3;var BGN_Channels={0:"1,2,3,4,5,6,7,8,9,10,11",1:"1,2,3,4,5,6,7,8,9,10,11,12,13",2:"10,11",3:"10,11,12,13",4:"14",5:"1,2,3,4,5,6,7,8,9,10,11,12,13,14",6:"3,4,5,6,7,8,9",7:"5,6,7,8,9,10,11,12,13"};var AN_Channels={0:'36,40,44,48,52,56,60,64,149,153,157,161,165',1:'36,40,44,48,52,56,60,64,100,104,108,112,116,120,124,128,132,136,140',2:'36,40,44,48,52,56,60,64',3:'52,56,60,64,149,153,157,161',4:'149,153,157,161,165',5:'149,153,157,161',6:'36,40,44,48',7:'36,40,44,48,52,56,60,64,100,104,108,112,116,120,124,128,132,136,140,149,153,157,161,165',8:'52,56,60,64',9:'36,40,44,48,52,56,60,64,100,104,108,112,116,132,136,140,149,153,157,161,165',10:'36,40,44,48,149,153,157,161',11:'36,40,44,48,52,56,60,64,100,104,108,112,116,120,149,153,157,161'};var DUAL_MODE={0:['2.4GHz',0,'99,4,6,9',BGN_Channels],1:['5GHz',1,'99,2,11,8',AN_Channels]};if("undefined"==typeof(skippass)){<%CFG_MAP(wifi_en,WIFI_EN);%><%CFG_MAP(wifi_region,WIFI_REGION_BGN);%><%CFG_MAP(wifi_wirelessmode,WIFI_WIRELESSMODE);%><%CFG_MAP(wifi_fixedtxmode,WIFI_FIXEDTXMODE);%><%CFG_MAP(wifi_ssid,WIFI_SSID);%><%CFG_MAP(wifi_ssid_hide,WIFI_SSID_HIDE);%><%CFG_MAP(wifi_chan,WIFI_CHAN);%><%CFG_MAP(wifi_curchan,STS_WIFI_CHAN);%><%CFG_MAP(wifi_autochsel,WIFI_AUTOCHSEL);%><%CFG_MAP(wifi_basicrate,WIFI_BASICRATE);%><%CFG_MAP(wifi_ex_wchan,WIFI_EXT_CHAN);%><%CFG_MAP(wifi_40mch,WIFI_40MCH);%><%CFG_MAP(bandwidth,WIFI_HT_BW);%><%CFG_MAP(wifi_protectmode,WIFI_BG_PROTECT);%><%CFG_MAP(wmmenable,WIFI_WME_EN);%><%CFG_MAP(wifi_country,WIFI_COUNTRY);%><%CFG_MAP(wifi_radius,WIFI_WPA_RADIUS);%><%CFG_MAP(wifi_authmode,WIFI_AUTHMODE);%><%CFG_MAP(wifi_encryptype,WIFI_ENCRYPTYPE);%><%CFG_MAP(wifi_wep_keyidx,WIFI_WEP_KEYIDX);%><%CFG_MAP(wifi_wep_keylen,WIFI_WEP_KEYLEN);%><%CFG_MAP(wifi_wep_keymode,WIFI_WEP_KEYMODE);%><%CFG_MAP_ARY(wifi_wep_key,WIFI_WEP_KEY,4,1);%><%CFG_MAP_ARY(wifi_wep64_key,WIFI_WEP64_KEY,4,1);%><%CFG_MAP(wifi_wep128_key,WIFI_WEP128_KEY,4,1);%><%CFG_MAP(wifi_wpa_obscure,WIFI_WPA_OBSCURE);%><%CFG_MAP_ARY(wifi_wpa_key,WIFI_WPA_KEY,4,1);%><%CFG_MAP(wps_version2,WIFI_WPS_VERSION2);%><%CFG_MAP(wps_en,WIFI_WPS_EN);%><%CFG_MAP(wps_en1,WIFI_WPS_EN+1);%><%CFG_MAP(wps_pin,WIFI_WPS_PIN);%><%CFG_MAP(wps_pin_try,STS_WIFI_WPS_PIN_SET);%><%CFG_MAP(wps_hw_btn,WIFI_WPS_BTN_EN);%><%CFG_MAP_ARY(wps_config_command,STS_WIFI_WPS_CFG)%><%CFG_MAP_ARY(wps_p_state,STS_WIFI_WPS_STATE)%><%CFG_MAP(wps_configured,WIFI_WPS_CONFIGED);%><%CFG_MAP(wifi_en1,WIFI_EN+1);%><%CFG_MAP(wifi_region1,WIFI_REGION_AN);%><%CFG_MAP(wifi_wirelessmode1,WIFI_5G_WIRELESSMODE);%><%CFG_MAP(wifi_fixedtxmode1,WIFI_5G_FIXEDTXMODE);%><%CFG_MAP(wifi_ssid1,WIFI_5G_SSID);%><%CFG_MAP(wifi_ssid_hide1,WIFI_5G_SSID_HIDE);%><%CFG_MAP(wifi_chan1,WIFI_5G_CHAN);%><%CFG_MAP(wifi_curchan1,STS_WIFI_CHAN+1);%><%CFG_MAP(wifi_autochsel1,WIFI_5G_AUTOCHSEL);%><%CFG_MAP(wifi_basicrate1,WIFI_5G_BASICRATE);%><%CFG_MAP(wifi_ex_wchan1,WIFI_5G_EXT_CHAN);%><%CFG_MAP(wifi_40mch1,WIFI_40MCH+1);%><%CFG_MAP(bandwidth1,WIFI_5G_HT_BW);%><%CFG_MAP(wifi_protectmode1,WIFI_5G_PROTECT);%><%CFG_MAP(wmmenable1,WIFI_5G_WME_EN);%><%CFG_MAP(wifi_country1,WIFI_5G_COUNTRY);%><%CFG_MAP(wifi_radius1,WIFI_5G_WPA_RADIUS);%><%CFG_MAP(wifi_authmode1,WIFI_5G_AUTHMODE);%><%CFG_MAP(wifi_encryptype1,WIFI_5G_ENCRYPTYPE);%><%CFG_MAP(wifi_wep_keyidx1,WIFI_5G_WEP_KEYIDX);%><%CFG_MAP(wifi_wep_keylen1,WIFI_5G_WEP_KEYLEN);%><%CFG_MAP(wifi_wep_keymode1,WIFI_5G_WEP_KEYMODE);%><%CFG_MAP_ARY(wifi_wep_key1,WIFI_5G_WEP_KEY,4,1);%><%CFG_MAP_ARY(wifi_wep64_key1,WIFI_5G_WEP64_KEY,4,1);%><%CFG_MAP(wifi_wep128_key1,WIFI_5G_WEP128_KEY,4,1);%><%CFG_MAP(wifi_wpa_obscure1,WIFI_5G_WPA_OBSCURE);%><%CFG_MAP_ARY(wifi_wpa_key1,WIFI_5G_WPA_KEY,4,1);%><%CFG_MAP(wps_unit,STS_WIFI_WPS_UNIT);%><%CFG_MAP(wps_method,STS_WIFI_WPS_METHOD);%><%CFG_MAP(wps_configured1,WIFI_WPS_CONFIGED+1);%><%CFG_MAP(enable_TKIP_n,WIFI_TKIP_EN_N);%>var from_wifi=(parseInt('0'+'<%CGI_ACCESS_FROM();%>')==3);<%CFG_MAP(same,WIFI_SAME_SET);%>}
var wifi_pg={'000':"wifi_no_sc.htm",'010':"wifi_wep64.htm",'011':"wifi_wep128.htm",'012':"wifi_wep152.htm",'020':"wifi_psk.htm",'030':"wifi_psk.htm",'040':"wifi_psk.htm",'110':"wifi_wpa.htm",'120':"wifi_wpa.htm",'120':"wifi_wpa.htm"}
var wifi_mod_s={0:"802.11 b/g mixed",1:"802.11 b",2:"802.11 a",3:"802.11 a/b/g mixed",4:"802.11 g",5:"802.11 a/b/g/n mixed",6:"802.11 n",7:"802.11 g/n mixed",8:"802.11a & 802.11n",9:"802.11b & 802.11g & 802.11n",10:"802.11 a/g/n",11:"802.11 n",99:"Off"};var wifi_rate_s=["1","2","5.5","11","6","9","12","18","24","36","48","54"];var wifi_sc_s={0:'318',1:'804',2:'803',3:'WPA-PSK',4:'WPA2-PSK',5:'1296',6:'WPA',7:'WPA2',8:'1297'};var bit_s={1:'64bit',2:'128bit',3:'152bit'};var encry_s={0:'',1:'TKIP',2:'AES',3:'TKIP+AES'};function get_wifi_baserate(idx){var k=DUAL_MODE[idx][DUAL_WL_BAND];k=((k==0)?'':k);var v=getCfg("wifi_wirelessmode"+k);return v;}
function set_wifi_baserate(idx,v){var k=DUAL_MODE[idx][DUAL_WL_BAND];k=((k==0)?'':k);var sc_mod=0;var vv=parseInt(v,10);if(vv==99){setCfg("wifi_en"+k,"0");}else{setCfg("wifi_wirelessmode"+k,vv);setCfg("wifi_en"+k,"1");if(vv==6||vv==9){setCfg("wifi_fixedtxmode"+k,'HT');setCfg("wifi_basicrate"+k,"15");}else if(vv==4){setCfg("wifi_fixedtxmode"+k,'OFDM');setCfg("wifi_basicrate"+k,"351");}}}
function get_wifi_channel(idx){var k=DUAL_MODE[idx][DUAL_WL_BAND];k=((k==0)?'':k);var v=getCfg("wifi_chan"+k);if(getCfgInt("wifi_autochsel"+k)==1)v=0;return v;}
function set_wifi_channel(idx,v){var k=DUAL_MODE[idx][DUAL_WL_BAND];k=((k==0)?'':k);var vv=parseInt(v,10);if(v==0)
setCfg("wifi_autochsel"+k,"1");else{setCfg("wifi_autochsel"+k,"0");setCfg("wifi_chan"+k,vv);}}
function get_wifi_extchannel(idx){var k=DUAL_MODE[idx][DUAL_WL_BAND];k=((k==0)?'':k);var v=getCfg("wifi_ex_wchan"+k);return v;}
function set_wifi_extchannel(idx,v){var k=DUAL_MODE[idx][DUAL_WL_BAND];k=((k==0)?'':k);if(v!=null)
setCfg("wifi_ex_wchan"+k,v);}
function get_wifi_chan_list(idx){var k=DUAL_MODE[idx][DUAL_WL_BAND];var ch_s=DUAL_MODE[idx][DUAL_WL_CHAN];var ch_all,ch_lst=[];k=((k==0)?'':k);var wifi_reg=getCfgInt("wifi_region"+k);ch_lst.push({desc:getLangM(377),key:0});var ch_all=ch_s[wifi_reg].split(",");for(var x in ch_all){if(!x||!ch_all[x])break;ch_lst.push({desc:ch_all[x],key:ch_all[x]});}
return ch_lst;}
function get_wifi_ssidbcst(idx){var k=DUAL_MODE[idx][DUAL_WL_BAND];k=((k==0)?'':k);var v=(getCfgInt("wifi_ssid_hide"+k)==1)?"0":"1";return v;}
function set_wifi_ssidbcst(idx,v){var k=DUAL_MODE[idx][DUAL_WL_BAND];k=((k==0)?'':k);if(v==1)
setCfg("wifi_ssid_hide"+k,"0");else{setCfg("wifi_ssid_hide"+k,"1");setCfg("wps_en"+k,"0");}}
function get_wifi_ssid(idx){var k=DUAL_MODE[idx][DUAL_WL_BAND];k=((k==0)?'':k);return getCfg("wifi_ssid"+k);}
function set_wifi_ssid(idx,v){var k=DUAL_MODE[idx][DUAL_WL_BAND];k=((k==0)?'':k);var obj=getCfgObj("wifi_ssid"+k);var o=obj.o;var n=setCfg("wifi_ssid"+k,v);return(n!=o);}
function get_wifi_authcfg(idx){var sc_mod=0;var k=DUAL_MODE[idx][DUAL_WL_BAND];k=((k==0)?'':k);var auth=getCfg("wifi_authmode"+k);if(auth=='OPEN')
sc_mod=0;else if(auth=='WEPAUTO'){sc_mod=2;if(parseInt(getCfg("wifi_wep_keylen"+k),10)==10)
sc_mod=1;}else if(auth=='WPAPSK')
sc_mod=3;else if(auth=='WPA2PSK')
sc_mod=4;else if(auth=='WPAPSKWPA2PSK')
sc_mod=5;else if(auth=='WPA')
sc_mod=6;else if(auth=='WPA2')
sc_mod=7;else if(auth=='WPAWPA2')
sc_mod=8;return sc_mod;}
function set_wifi_authcfg(idx,_mod,_key){var sc_mod=0;var k=DUAL_MODE[idx][DUAL_WL_BAND];k=((k==0)?'':k);switch(_mod)
{case 0:default:setCfg("wifi_radius"+k,'0');setCfg("wifi_authmode"+k,"OPEN");setCfg("wifi_encryptype"+k,"NONE");break;case 1:wep=getWEPAry(idx);wep[WEP_MOD]=(_key.length==10)?1:2;wep[WEP_KEY]=0;wep[WEP_PHAS]=0;wep[WEP_KEYSZ]=_key.length;if(_key.length==10)
wep[WEP_KEYS+1]=_key;else
wep[WEP_KEYS]=_key;setWEPAry(idx,wep);break;case 3:case 2:var wifi_mode=get_wifi_baserate(idx);var wpa=getWPACfg(idx);wpa[WPA_MOD]=_mod;wpa[WPA_PSK]=1;wpa[WPA_PH]=1;wpa[WPA_OBS]=1;wpa[WPA_KEY]=_key;setWPACfg(idx,wpa);}}
function get_wifi_uimode(idx){var sc_mod=get_wifi_authcfg(idx);if(sc_mod==3||sc_mod==4)
sc_mod=5;return sc_mod;}
function get_wifi_uiencry(idx){var mod=0;var k=DUAL_MODE[idx][DUAL_WL_BAND];k=((k==0)?'':k);var encry=getCfg("wifi_encryptype"+k);if(encry=='TKIP')
mod=1;else if(encry=='AES')
mod=2;else if(encry=='TKIPAES')
mod=3;return mod;}
function get_wifi_sc_str(mod){return getLangC(wifi_sc_s[mod]);}
function getwifi_sc(idx){var wifi_sc=get_wifi_uimode(idx);return get_wifi_sc_str(wifi_sc);}
function getwifi_encry(idx){var wifi_sc=get_wifi_uimode(idx);if(wifi_sc!=5){return'';}
var encry=get_wifi_uiencry(idx);var wifi_mode=get_wifi_baserate(idx);var en_TKIP_n=getCfgInt("enable_TKIP_n");if((wifi_mode>=5)&&(wifi_mode<=11)&&(en_TKIP_n==0))
encry=2;return encry_s[encry];}<%CFG_MAP(rt_en,RT_EN);%><%CFG_MAP(ap_ip,LAN_AP_IP);%><%CFG_MAP(ap_msk,LAN_AP_MSK);%><%CFG_MAP(lan_ip,LAN_IP);%><%CFG_MAP(lan_mask,LAN_MSK);%><%CFG_MAP(back_lan_ap_ip,BACK_LAN_AP_IP);%><%CFG_MAP(back_lan_ap_msk,BACK_LAN_AP_MSK);%><%CFG_MAP(clone_mod,WAN_CLONE_EN);%><%CFG_MAP(wan_hw_mac,HW_WAN_MAC);%><%CFG_MAP(wan_mac,WAN_CLONE_MAC);%>var pc_mac='<% CGI_ACCESS_MAC();%>';<%CFG_MAP(fw_en,FW_EN);%>var MAX_DEV_NUM=200;var DEVO_IP=0;var DEVO_MAC=1;var DEVO_MANU=2;var DEVO_TYPE=3;var DEVO_NAME=4;var DEV_MAC=0;var DEV_RESV_IP=1;var DEV_ISRESV=2;var DEV_TYPE=3;var DEV_NAME=4;var DEV_IDX=10;var devType=['laptop','netcam','phone','printer','tablet','tv','settop','wemo','game','generic'];function gen_empty_DEVM(){var DEVM=['','0','0','0',''];DEVM[DEV_IDX]=-1;return DEVM;}
function get_DEVM(idx){if(idx>MAX_DEV_NUM)return null;var DEVM=getCfgAry("pc_lst"+idx);if(!DEVM||(DEVM.length<2)||DEVM[DEV_MAC]==''){DEVM=gen_empty_DEVM();}else{DEVM[DEV_IDX]=idx;}
return DEVM}
function get_DEV(idx){if(idx>MAX_DEV_NUM)return null;var DEVM;var dev_mac;var dev;if(cgi_devs_list){dev=cgi_devs_list[idx-1];}
if(dev){DEVM=findDEVMByMac(unescape(dev[DEVO_MAC]));}else{return null;}
var dev_mac=unescape(dev[DEVO_MAC]);var dev_manufact=unescape(dev[DEVO_MANU]);var dev_ip=unescape(dev[DEVO_IP]);var res_ip=DEVM[DEV_RESV_IP];var dev_hostname=unescape(dev[DEVO_NAME]);var dev_type=unescape(dev[DEVO_TYPE]);var dev_label=dev_hostname;var dev_reserv=parseInt(DEVM[DEV_ISRESV]);var DEV={idx:idx-1,DEVM_idx:DEVM[DEV_IDX],host:dev_hostname,manuf:dev_manufact,hostlabel:dev_label,mac:dev_mac.toUpperCase(),ip:dev_ip,res_ip:res_ip,isReserv:dev_reserv,type:parseInt(dev_type),is_null:(DEVM[DEV_IDX]==-1)?1:0};return DEV;}
function findDEVByMac(mac,host){var DEV;var c_mac=mac.toUpperCase();for(var i=1;i<=MAX_DEV_NUM;i++){DEV=get_DEV(i);if(DEV.idx==-1)break;if((DEV.mac==c_mac))break;}
return DEV;}
function set_DEVM(DEV){var idx=DEV.DEVM_idx;if(idx==-1)idx=findEmptyDEVMidx();if(idx<1||idx>MAX_DEV_NUM)return-1;var DEVM=getCfgAry("pc_lst"+idx);if(!DEVM)DEVM=[];DEVM[DEV_NAME]=DEV.host;DEVM[DEV_TYPE]=DEV.type;DEVM[DEV_MAC]=DEV.mac;DEVM[DEV_RESV_IP]=DEV.res_ip;DEVM[DEV_ISRESV]=DEV.isReserv;setCfgAry("pc_lst"+idx,DEVM);return idx;}
function findDEVMByMac(mac){var DEVM;var c_mac=mac.toUpperCase();for(var i=1;i<=MAX_DEV_NUM;i++){DEVM=get_DEVM(i);if(DEVM[DEV_IDX]<0)continue;if((DEVM[DEV_MAC].toUpperCase()==c_mac)){return DEVM;}}
return gen_empty_DEVM();}
function findEmptyDEVMidx(){for(var i=1;i<=MAX_DEV_NUM;i++){DEVM=get_DEVM(i);if(DEVM[DEV_IDX]<0){return i;}}
return-1;}
function str2Type(s){for(var x in devType)
if(devType[x]==s)return x;return 0;}
function type2Str(x){if(x<0)x=9;return devType[x];}
function nextType(x){return(x+1)%devType.length;}
function fixHostLabel(mac,hostname){if(hostname.length==0){hostname=findArpHostName(mac);if(hostname.length==0){}}
return hostname;}
function findArpHostName(mac){var pc;var pcs=0;if(!ARPentry)return;while((pc=ARPentry(pcs++))){if(pc.mac=="")continue;if(pc.mac!==mac)continue;return pc.host;}
return"";}<%CFG_MAP_ARY(pc_lst,LAN_LEASES,50,1);%>var xmlURL="bwdet.xml";var SPEED_TEST_TIMEOUT=90;var speedTestTime=SPEED_TEST_TIMEOUT;var spWatchTimeOut=0;var BWDET_ST=0;var BWDET_RECORD_TYPE=0;var BWDET_PING=1;var BWDET_UL_SPEED=2;var BWDET_DL_SPEED=3;var BWDET_RECORD_TIME=4;var bwType=0;var MAX_SPEED_LIMIT=60;var MIN_SPEED_LIMIT=0.01;var HW_MAX_SPEED_LIMIT=100;function getBwRst(aryBw){var bwObj={qos_en:0,recPing:"",recUpload:"",recDownload:"",recDate:"",recType:NaN,st:99,tmpPing:"",tmpUpload:"",tmpDownload:""};if(aryBw){bwObj.qos_en=parseInt(aryBw[0],10);var tmp=aryBw[1].toString().split(";");if(tmp.length>1){bwObj.recType=parseInt(tmp[BWDET_RECORD_TYPE],10);bwObj.recPing=(bwObj.recType==1)?tmp[BWDET_PING]:"";bwObj.recUpload=tmp[BWDET_UL_SPEED];bwObj.recDownload=tmp[BWDET_DL_SPEED];bwObj.recDate=tmp[BWDET_RECORD_TIME];}
tmp=aryBw[2].toString().split(";");if(tmp.length>1){bwObj.st=parseInt(tmp[BWDET_ST],10);switch(bwObj.st){case 0:case 3:bwObj.tmpDownload=tmp[BWDET_DL_SPEED];case 2:bwObj.tmpUpload=tmp[BWDET_UL_SPEED];case 1:bwObj.tmpPing=tmp[BWDET_PING];default:}}}else{bwObj.qos_en=getCfgInt("qos_en");var objRec=getCfgAry("bwdet_rec");if(objRec&&objRec.length>1){bwObj.recType=parseInt(objRec[BWDET_RECORD_TYPE],10);bwObj.recPing=(bwObj.recType==1)?objRec[BWDET_PING]:"";bwObj.recUpload=(getCfgFloat("upload_speed")*getCfgInt("dl_bw_unit")/1000).toFixed(2);bwObj.recDownload=(getCfgFloat("download_speed")*getCfgInt("ul_bw_unit")/1000).toFixed(2);bwObj.recDate=objRec[BWDET_RECORD_TIME];}}
return bwObj;}
function setBwRst(bwObj){var bw_rec="";if(bwObj.qos_en==1){bw_rec+=bwType+";";bw_rec+=(bwType==1)?bwObj.tmpPing+";":";";bw_rec+=bwObj.tmpUpload+";";bw_rec+=bwObj.tmpDownload+";";dateObj=new Date();var dateTmp=dateObj.getFullYear()+"/"+(dateObj.getMonth()+1)+"/"+dateObj.getDate()+' '+dateObj.getHours()+':'+dateObj.getMinutes();bw_rec+=dateTmp;setCfg("bwdet_rec",bw_rec);var objCfgTmp=getCfgObj("bwdet_tmp");objCfgTmp.o="tmp";objCfgTmp.v="";setCfgObj("bwdet_tmp",objCfgTmp);setCfg("upload_speed",bwObj.tmpUpload*1000);setCfg("download_speed",bwObj.tmpDownload*1000);setCfg("ul_bw_unit",1);setCfg("dl_bw_unit",1);setCfg("qos_en",bwObj.qos_en);setCfg("bwdet_ctrl",0);}
else{setCfg("qos_en",bwObj.qos_en);}}<%CFG_MAP(qos_en,QOS_EN);%><%CFG_MAP(bwdet_ctrl,BWDET_CTRL);%><%CFG_MAP(bwdet_rec,BWDET_REC);%><%CFG_MAP(bwdet_tmp,STS_BWDET_TMP);%><%CFG_MAP(download_speed,QOS_DOWNSTREAM_SPEED);%><%CFG_MAP(dl_bw_unit,QOS_DOWNSTREAM_SPEED_UNIT);%><%CFG_MAP(upload_speed,QOS_UPSTREAM_SPEED);%><%CFG_MAP(ul_bw_unit,QOS_UPSTREAM_SPEED_UNIT);%><%CFG_MAP(dns_type,WAN_SEC_DNS_TYP);%><%CFG_MAP(dns_sec,WAN_SEC_DNS);%><%CFG_MAP(ntp_en,SYS_NTP_EN);%><%CFG_MAP(ntp_tzone,SYS_TZONE_IDX);%><%CFG_MAP(ntp_serv_idx,SYS_NTPSRV_IDX);%><%CFG_MAP(ntp_daylite_mod,SYS_DAYLITE_EN);%>var cgi_ntp_conn=<%CFG_GET(STS_NTP_CONN);%>;var ntp_zone_array={0:"2300",1:"2301",2:"2302",3:"2303",4:"2304",5:"2305",6:"2306",7:"2307",8:"2308",9:"2309",10:"2310",11:"2311",12:"2312",13:"2313",14:"2314",15:"2315",16:"2316",17:"2317",18:"2318",19:"2319",20:"2320",21:"2321",22:"2359",23:"2322",24:"2323",25:"2324",26:"2360",27:"2325",28:"2326",29:"2327",30:"2328",31:"2329",32:"2330",33:"2331",34:"2332",35:"2333",36:"2334",37:"2335",38:"2336",39:"2337",40:"2338",41:"2339",42:"2340",43:"2341",44:"2342",45:"2343",46:"2344",47:"2345",48:"2346",49:"2347",50:"2348",51:"2349",52:"2350",53:"2361",54:"2351",55:"2352",56:"2353",57:"2354",58:"2355",59:"2356",60:"2357",61:"2362",62:"2363",63:"2358",9999:null};var time_server=[[0,'1375'],[1,'1376'],[2,'Aust_Nzl'],[3,'1377']];var ARP_IP=0;var ARP_HW_TYP=1;var ARP_FLAG=2;var ARP_MAC=3;var ARP_MASK=4;var ARP_IF=5;var ARP_WIFI=6;var ARP_HOST=7;function ARPentry(idx){if(cgi_arp_list[idx]){a=cgi_arp_list[idx];var ARP={idx:idx,ip:HTML2str(a[ARP_IP]),hwtyp:HTML2str(a[ARP_HW_TYP]),flag:HTML2str(a[ARP_FLAG]),mac:HTML2str(a[ARP_MAC]),mask:HTML2str(a[ARP_MASK]),ifna:HTML2str(a[ARP_IF]),host:HTML2str(a[ARP_HOST])}
if(ARP.mac=="00:00:00:00:00:00")ARP.mac="";ARP.mac=ARP.mac.toUpperCase();return ARP;}
return null;}
function addARPentry(mac,host){var lidx=cgi_arp_list.length;cgi_arp_list[lidx]=['','1','0',mac,'%2A','br0','0',host];return lidx;}
function findARPbyMAC(mac){var pc;var pcs=0;if(!ARPentry)return;while((pc=ARPentry(pcs++))){if(pc.mac=="")continue;if(pc.mac!==mac)continue;return pc;}
return null;}
var cgi_arp_list=[<%CFG_ARY(STS_RT_ARP_LST,255);%>null];var cgi_wan_if='<%CFG_GET(STS_WAN_IFNAME);%>';var MAX_UNSHARE_SZ=30;var BELKIN_FRIENDLYNAME_POSTFIX="_MediaServer";<%CFG_MAP(dlna_wifi_ssid,WIFI_SSID);%><%CFG_MAP(dlna_en,MS_EN);%><%CFG_MAP(dlna_ready,MS_READY);%><%CFG_MAP(dlna_USB,MS_USB);%><%CFG_MAP(friendly_name,MS_FRIENDLY_NAME);%><%CFG_MAP_ARY(twonkydir,MS_TWONKY_DIR_LST+1,30,1);%>var cgi_devs_list=[<%CFG_ARY(STS_DEVS_LST,256);%>null];