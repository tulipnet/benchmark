<!DOCTYPE html><!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7"lang="en"> <![endif]--><!--[if IE 7]> <html class="no-js lt-ie9 lt-ie8"lang="en"> <![endif]--><!--[if IE 8]> <html class="no-js lt-ie9"lang="en"> <![endif]--><!--[if gt IE 8]><!--><html lang="en"class="gt-ie8"><!--<![endif]--><!--[if IE]><html xmlns="http://www.w3.org/1999/xhtml"xmlns:v><![endif]--><head><meta charset="utf-8"/><meta name="viewport"content="width=device-width"/><title></title> <link rel="icon"href="images/favicon/favicon.ico"><link rel="apple-touch-icon-precomposed"sizes="144x144"href="images/favicon/belkin_144.png"><link rel="apple-touch-icon-precomposed"sizes="114x114"href="images/favicon/belkin_114.png"><link rel="apple-touch-icon-precomposed"sizes="72x72"href="images/favicon/belkin_72.png"><link rel="apple-touch-icon-precomposed"href="images/favicon/belkin_57.png"><link rel="stylesheet"href="stylesheets/app.css?t=20140212"><!--[if lt IE 9]><link rel="stylesheet"href="stylesheets/ie.css"><![endif]--><!--[if IE]><?import namespace="v"implementation="#default#VML"?><![endif]--><script>var LangJ=["menulist","help","comm","fw_mac"];var CGIs=["fw_mac","dhcp"];</script><script src="javascripts/init.js"></script><script src="javascripts/jquery.min.js"></script><script src="javascripts/global.js"></script><script src="javascripts/app.js"></script><script src="javascripts/menu.js"></script></head><body style="display:none"id="mainbody"> <script><%CGI_INCLUDE(javascripts/main_header.js);%></script><script src="javascripts/routine.js"></script><div class="main container"> <div class="row"><div class="eight columns"><form class="nice"name="tF"method="post"action="/cgi-bin/setup_lan.exe"target="OUTfrm"><div class="row"> <div class="twelve columns"><br><br><p class="drop-ip"><label class="has-more"> <input type="checkbox"name="macacc_en"value="1"onClick="MAC_En_Disable()">&nbsp;&nbsp; <b><span tid="106"></span></b></label> </p> <p class="drop-ip"><label class="has-more"><b><span tid="107"></span></b></label> <div id="div_tb"> <table border=0 id="tb_fw_mac"class="minimal nofirst"width="550"> <thead> <tr> <th>&nbsp;</th> <th width=330><b><span tid="110"></span></b></th> <th width=170></th> </tr> <tr id="u_AddEntry"style="display:none"> <td class="middle">&nbsp;</td> <td class="middle"><input type="hidden"name="cusmod"value="0"> <nobr> <input value=""maxlength="2"size="3"name="cusmac">&nbsp;:&nbsp;&nbsp;<input value=""maxlength="2"size="3"name="cusmac">&nbsp;:&nbsp;&nbsp;<input value=""maxlength="2"size="3"name="cusmac">&nbsp;:&nbsp;&nbsp;<input value=""maxlength="2"size="3"name="cusmac">&nbsp;:&nbsp;&nbsp;<input value=""maxlength="2"size="3"name="cusmac">&nbsp;:&nbsp;&nbsp;<input value=""maxlength="2"size="3"name="cusmac"> </nobr> </td> <td class="middle"width="170"> <a href="#add"class="nice radius small green button margin-rows"tid="113"onClick="return add_entry()"id="btnadd"></a> </td> </tr> </thead> <tbody> </tbody> </table> </div><div id="div_catch"></div> </p></div></div><br><a href="#save"class="nice radius medium green button"tid="49"onClick="return evaltF()"id="btnapply"></a></form></div><div class="sidebar four columns"> <div><h6><b><span tid="26"></span></b></h6> <p> <span tid="105"></span> <span class="nub"></span></p> </div> </div></div> </div><script>/*JS_PACKER*/var cgi_totalCount=0;function f_Mac(name){var mac=["","","","","",""];var mac_s,obj;for(var i=0;i<=5;i++){obj=eval(name+i);if(obj)
mac[i]=obj.value;}
mac_s=mac.join(":");return mac_s.toUpperCase();}
function PushCatch(){var h=$I("div_tb").innerHTML.replace(/name=/ig,'test=');HiddenObject("tb_fw_mac");$I("div_catch").innerHTML=h;}
function PopCatch(){$I("div_catch").innerHTML="";DisplayObject("tb_fw_mac");}
var mac_array=new Array(35);function ShowAddEntry(){if(cgi_totalCount<MAX_MAC_TABLE){DisplayObject("u_AddEntry");}else{HiddenObject("u_AddEntry");}}
function addTableEntry(_idx,_en,_mac){var f=document.tF;var obj;var RowCell,c1,c2,c3,c4;var mac,rowcnt;var adm_mac_s=getCfg("admin_mac");var isadmin=(adm_mac_s==_mac);c1=_idx+1;c2='<input type="hidden" name="mod'+_idx+'" value="'+FW_ALLOW+'">';c2+='<nobr>';if(_mac)
mac=_mac.split(":");else
mac=['','','','','',''];for(var i=0;i<=5;i++){c2+='<input type="text" name="MAC'+_idx+'" size="3" maxlength="2" value="'+mac[i]+'">';c2+=(i==5)?'':'&nbsp;:&nbsp;&nbsp;';}
c2+='</nobr>';c3='<a href="#del" class="nice radius small green button margin-rows box" onClick="del_entry('+(_idx)+')" id="u_del'+(_idx)+'">'+getLangM(114)+'</a>';RowCell=[[1,c1,{'class':'middle','align':'center'}],[1,c2,{'class':'middle','align':'center','width':'330'}],[1,c3,{'align':'center','width':'170'}],[null,null]];rowcnt=Table_get_rows("tb_fw_mac");Table_add_row("tb_fw_mac",[[3,rowcnt,3],RowCell],0);SetFieldValue(eval('f.mod'+_idx),_en);if(isadmin){DisableObject(eval('f.mod'+(_idx)));DisableObject("u_del"+(_idx));obj=eval('f.MAC'+(_idx));for(var i=0;i<=5;i++){DisableObject(obj[i]);}}
mac_array[_idx]=[_en,_mac];return rowcnt;}
function SetMode(_idx){var f=document.tF;var block_mod=getFieldValue(eval('f.mod'+_idx))?1:0;if(mac_array[_idx]){mac_array[_idx][FW_MOD]=block_mod;}}
var in_action=0;function add_entry(){if(in_action)return false;var f=document.tF;var rc=1;var objmac=eval('f.cusmac');var objmod=eval('f.cusmod');var mac_s=combinMAC2(objmac);var mac_block=(getFieldValue(objmod)=="1")?FW_DENY:FW_ALLOW;var idx=cgi_totalCount;if(cgi_totalCount>=MAX_MAC_TABLE){AlertM(1602);return false;}
if(mac_s==":::::"){AlertM(669);return false;}
if((rc=isValidMacAddress(mac_s))!=0){alert(getLangM(902)+":"+mac_s+".\n"+getLangM(904)+" "+getLangM(903));document.tF.cusmac[rc-1].focus();return false;}
for(var i=0;i<cgi_totalCount;i++){if(mac_s==combinMAC2(eval("f.MAC"+i))){AlertM(112);return false;}}
in_action=1;addTableEntry(idx,mac_block,mac_s);decomMAC2(objmac,"");cgi_totalCount++;ShowAddEntry();in_action=0;return false;}
function del_entry(_idx){var i,k;if(in_action)return false;var f=document.tF;var mac_en=getFieldValue(f.macacc_en)?1:0;var mac_s=combinMAC2(eval('f.MAC'+_idx));var adm_mac_s=getCfg("admin_mac");if((mac_en==1)&&(mac_s==adm_mac_s)){AlertM(1062);return false;}
in_action=1;PushCatch();for(i=_idx;i<cgi_totalCount-1;i++){k=(i+1);mac_s=combinMAC2(eval('f.MAC'+(k)));mac_en=(getFieldValue(eval('f.mod'+(k)))==1)?FW_DENY:FW_ALLOW;mac_array[i]=[mac_en,mac_s];}
mac_array.length=cgi_totalCount-1;PopCatch();ShowMacTable();ShowAddEntry();in_action=0;return false;}
function ShowMacTable(){var f=document.tF;var adm_mac_s=getCfg("admin_mac");var mac_en=getFieldValue(f.macacc_en)?FW_DENY:FW_ALLOW;var hasadmin=0;var rec_cnt=0;Table_del_row("tb_fw_mac",0,0,1);for(var i=0;i<cgi_totalCount;i++){mac=mac_array[i];if(mac){rowcnt=addTableEntry(rec_cnt,mac[FW_MOD],mac[FW_MAC]);rec_cnt++;if(adm_mac_s==mac[FW_MAC])hasadmin=1;}}
cgi_totalCount=rec_cnt;if(!hasadmin){addTableEntry(cgi_totalCount++,FW_ALLOW,adm_mac_s);}
ShowAddEntry();}
function MAC_En_Disable(){ShowMacTable();}
function evaltF(){var f=document.tF;var rc=0;var mac_en=getFieldValue(f.macacc_en)?1:0;var adm_mac_s=getCfg("admin_mac");var obj,mac_s,macacc,obj2,mac_s2;var hasadmin=0;var mac_count=1;for(var i=0;i<MAX_MAC_TABLE;i++){obj=eval('f.MAC'+(i));macacc='';if(!obj||!obj.length||(obj.length<=1))continue;macacc=[0,''];mac_s=combinMAC2(obj);macacc=[FW_ALLOW,mac_s];rc=1;if(!mac_s||((rc=isValidMacAddress(mac_s))!=0)){alert(getLangM(902)+':'+mac_s+'.\n'+getLangM(903));obj[rc-1].focus();return false;}
obj=eval('f.mod'+(i));if(obj){macacc[FW_MOD]=(getFieldValue(obj)==1)?FW_DENY:FW_ALLOW;}
if(mac_s==adm_mac_s){hasadmin=1;}
for(var j=i+1;j<MAX_MAC_TABLE-1;j++){obj2=eval('f.MAC'+j);if(obj2&&(obj2.length>1)){mac_s2=combinMAC2(obj2);if(mac_s2==mac_s){alert((j+1)+'th MAC '+mac_s2+':'+getLangM(112));obj2[0].focus();return false;}}}
setCfgAry("mac_lst"+(mac_count++),macacc);}
if(mac_en&&!hasadmin){macacc=[FW_ALLOW,adm_mac_s];setCfgAry("mac_lst"+(mac_count++),macacc);}
for(var i=mac_count;i<=MAX_MAC_TABLE;i++){setCfg("mac_lst"+i,"");}
form2Cfg(f);return subForm({frm:f,cmd:"MAC_CONF",wait:6});}
function cfg2MacArray(){cgi_totalCount=0;mac_array=[];var mac_en=getCfgInt("macacc_en");var adm_mac_s=getCfg("admin_mac");var hasadmin=0;for(var i=0;i<MAX_MAC_TABLE;i++){mac=getCfgAry("mac_lst"+(i+1));if(mac){if(parseInt(mac[FW_MOD],10)!=-1&&mac[FW_MAC]){if(mac[FW_MAC]==adm_mac_s)hasadmin=1;addTableEntry(cgi_totalCount++,mac[FW_MOD],mac[FW_MAC]);}}}
if(!hasadmin){if(cgi_totalCount>=MAX_MAC_TABLE){del_entry(cgi_totalCount-1);}else{addTableEntry(cgi_totalCount++,FW_ALLOW,adm_mac_s);}}}
function init(){var f=document.tF;cfg2Form(f);cfg2MacArray();ShowAddEntry();ShowNavMenu();}
/*END_JS_PACKER*/<%CGI_LOGIN_KEEP();%></script> <script><%CGI_INCLUDE(javascripts/main_footer.js);%></script>