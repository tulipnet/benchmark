<!DOCTYPE html><!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7"lang="en"> <![endif]--><!--[if IE 7]> <html class="no-js lt-ie9 lt-ie8"lang="en"> <![endif]--><!--[if IE 8]> <html class="no-js lt-ie9"lang="en"> <![endif]--><!--[if gt IE 8]><!--><html lang="en"class="gt-ie8"><!--<![endif]--><!--[if IE]><html xmlns="http://www.w3.org/1999/xhtml"xmlns:v><![endif]--><head><meta charset="utf-8"/><meta name="viewport"content="width=device-width"/><title></title> <link rel="icon"href="images/favicon/favicon.ico"><link rel="apple-touch-icon-precomposed"sizes="144x144"href="images/favicon/belkin_144.png"><link rel="apple-touch-icon-precomposed"sizes="114x114"href="images/favicon/belkin_114.png"><link rel="apple-touch-icon-precomposed"sizes="72x72"href="images/favicon/belkin_72.png"><link rel="apple-touch-icon-precomposed"href="images/favicon/belkin_57.png"><link rel="stylesheet"href="stylesheets/app.css?t=20140212"><!--[if lt IE 9]><link rel="stylesheet"href="stylesheets/ie.css"><![endif]--><!--[if IE]><?import namespace="v"implementation="#default#VML"?><![endif]--><script>var LangJ=["comm","lan_dhcp","menulist","help","fw_pic"];var CGIs=["lan","leases"];G_NO_APPLY=1;</script><script src="javascripts/init.js"></script><script src="javascripts/jquery.min.js"></script><script src="javascripts/jQueryRotateCompressed.2.2.js"></script><script src="../javascripts/jquery.color-2.1.2.min.js"></script><script src="javascripts/global.js"></script><script src="javascripts/app.js"></script><script src="javascripts/menu.js"></script><script src="javascripts/routine.js"></script></head><body style="display:none"id="mainbody"> <script><%CGI_INCLUDE(javascripts/main_header.js);%></script><div class="main container"id="pa200"> <div class="row"> <div class="eight columns"> <div class="spacer11 tpad30"> <h3 tid="gtConnDev"class="hide-on-phones"></h3> <h3 class="PICListHeader"id="pa200t001"tid="PIC-S1t010"></h3> <img class="PICLoading"id="PICLoadingImg"src="../images/loading.gif"> <div class="row"> <div class="twelve columns"> <ul class="PICOnNet"> </ul> </div> </div> <div class="row"id="recent"style="display:none"> <div class="twelve columns"><h5 class="PICListHeader"id="pa200t002"tid="pa200t002"></h5> <ul class="PICOffNet"> </ul> </div> </div> </div> <a style="display:none;"id="pa200a005"tid="gtRefresh"href="#"class="button nice radius green"></a> </div><div class="sidebar four columns"> <div> <h6 tid="htConnDev"class="tpad30"></h6> <p><span tid="htConnDevContent"></span><span class="nub"></span></p> </div> </div></div></div><div id="dev_template"style="display:none"> <div class="ConnDevName radius6"> <div class="ConnDevNameDetail"> <span alt=""class="ConnDevIcon"id="%d_Icon"></span> <a style="xdisplay:inline-block;"id="%d_DetailsToggle"href="#"class="ConnDevToggle"> <img alt="Caret"id="%d_caret"class="PICCaret"src="../images/btn-Caret2.png"style=";"> </a> <h2 class="ConnDevSaved"tid="gtSaved"id="%d_Saved"></h2><input type="text"value=""id="%dNameInput"name="NameInput"maxlength=63 class="input-text autosizeNormal"style="display:none;"> <span id="%dName"class="ConnDevNameTxt"></span> <br><span id="%d_Line2"></span> <img id="%d_locked"src="../images/icon-Lock.png"class="lockIcon"> </div> <div style="clear:both;"></div> <small class="error withtop ConnDevSaveMe"id="%d_SaveMe"tid="pa200t005"style="display:none"></small> <small class="error withtop ConnDevSaveMe"id="%d_ReconnectMe"tid="pa200t006"style="display:none;"></small> <small class="error withtop ConnDevSaveMe"id="%d_SaveMeUnreserve"tid="pa200t007"style="display:none"></small><div style="display:none"id="%d_details"class="ConnDevDetails"> <div class="Details"> <div class="AddressDetails"><span tid="gtIPAddress"class="label"></span><span id="%d_IP_Fixed"></span><span id="%d_IP_Reserve"class="IPReserve"></span> &nbsp;<span id="%d_IP_ReserveForm"><input id="%d_IP_ReserveInput"name="IP_ReserveInput"type="text"class="input-text autosizeNormal"value=""size="3"maxlength="3"style="display:none;"></span><a class="tiny white button radius nice"id="%d_ReserveToggle"tid="gtReserve"></a>&nbsp;<span class="more hide-on-phones inline-block"><span class="desc"tid="pa200t003"></span></span> <br/><small id="%dResError1"class="error withtop"tid="pa200t004"style="display:none;"></small> <small id="%dResError"class="error withtop"tid="pa200t008"style="display:none;"></small> <small class="error withtop"id="%d_ReconnectMeDetails"tid="pa200t006"></small> <span tid="gtMACAddress"class="label"></span><span id="%d_MAC"></span> </div> </div><a href="#"tid="gtSave"class="ConnDevSave button nice radius large green"id="%d_save"></a> </div></div></div><script>var DEVS=[];var oldVal={};function addShowDetailsHandler(devName){var devIDs=["#"+devName+"_DetailsShow","#"+devName+"_details","#"+devName+"Name","#"+devName+"NameInput","#"+devName+"_caret","#"+devName+"_DetailsToggle","#"+devName+"_Line2","#"+devName+"_IP_ReserveInput","#"+devName+"_save","#"+devName+"_locked","#"+devName+"_ReconnectMeDetails"];var msgIDs=["#"+devName+"_SaveMe","#"+devName+"_ReconnectMe","#"+devName+"_SaveMeUnreserve"];$(devIDs[5]).click(function(e){e.preventDefault();if($(devIDs[1]).is(":hidden")){$(devIDs[2]).hide();$(devIDs[3]).show();$(devIDs[1]).slideDown();oldVal[devName]={"IP":$(devIDs[6]).html()};$(devIDs[6]).html(DEVS[devName].manuf);if(isDisplayObject((devIDs[9]).slice(1))){$("#"+devName+"_ReserveToggle").html(getLangM("gtUnreserve"));$("#"+devName+"_IP_Reserve").show();$(devIDs[7]).hide();$(devIDs[9]).hide();}else{$("#"+devName+"_ReserveToggle").html(getLangM("gtReserve"));$("#"+devName+"_IP_Reserve").hide();$(devIDs[7]).show();}
$(devIDs[4]).rotate({animateTo:0,duration:600});$(msgIDs.join(',')).slideUp();}else{var isReservedNotSaved=($(devIDs[7]).is(":hidden")&&!DEVS[devName].isReserv),isSavedNotSame=(DEVS[devName].res_ip!=DEVS[devName].ip),isUnreservedNotSaved=(!$(devIDs[7]).is(":hidden")&&DEVS[devName].isReserv);if(isReservedNotSaved){$(msgIDs[0]).html(getLangM("pa200t005").replace('{{REPLACE WITH RESERVED ADDRESS}}',oldVal[devName]["IP"].replace(/<b>|<\/b>/g,''))).slideDown();}else
if(isUnreservedNotSaved){$(msgIDs[2]).slideDown();}else
if(isSavedNotSame){$(msgIDs[1]).slideDown();}
$(devIDs[2]).show();$(devIDs[3]).hide();$(devIDs[1]).slideUp();$(devIDs[6]).html(oldVal[devName]["IP"]);if($(devIDs[7]).is(":hidden"))
$(devIDs[9]).show();$(devIDs[4]).rotate({animateTo:180,duration:600});}});$(devIDs[3]).bind("change keyup input",function(){$(devIDs[8]).removeClass('disabled');});}
function addReserveButttonHandler(devName){var devIDs=["#"+devName+"_ReserveToggle","#"+devName+"_IP_Reserve","#"+devName+"_IP_ReserveInput","#"+devName+"_save"];$(devIDs[2]).blur(function(){$("#"+devName+"ResError").hide();$("#"+devName+"ResError1").hide();var err=checkIP(devName);if(err==-1){$("#"+devName+"ResError1").show();return false;}else if(err!=0){$("#"+devName+"ResError").html(getLangM("pa200t008").replace('{{REPLACE WITH CONFLICTING DEVICE NAME}}',DEVS[err].hostlabel)).show();return false;}});$(devIDs[0]).click(function(e){e.preventDefault();if(!isDisplayObject((devIDs[1]).slice(1))){if(!$("#"+devName+"ResError").is(":hidden")){return false;}
if(!$("#"+devName+"ResError1").is(":hidden")){return false;}
oldVal[devName]={"IP":$("#"+devName+"_IP_Fixed").html()+'<b>'+$(devIDs[2]).val()+'</b>'};$(devIDs[1]).html($(devIDs[2]).val());$(devIDs[1]).show();$(devIDs[2]).hide();$(devIDs[0]).text(getLangM("gtUnreserve"));}else{oldVal[devName]={"IP":$("#"+devName+"_IP_Fixed").html()+'<b>'+DEVS[devName].ip.replace(re,'')+'</b>'};$(devIDs[2]).show();$(devIDs[1]).hide();$(devIDs[0]).text(getLangM("gtReserve"));}
$(devIDs[3]).removeClass('disabled');});}
function addSaveButtonHandler(devName){var devIDs=["#"+devName+"_save","#"+devName+"_DetailsToggle","#"+devName+" .ConnDevName","#"+devName+"_Saved","#"+devName+"_caret","#"+devName+"_IP_ReserveInput","#"+devName+"_locked","#"+devName+"_Icon"];var msgIDs=["#"+devName+"_SaveMe","#"+devName+"_ReconnectMe","#"+devName+"_SaveMeUnreserve"];$(devIDs[0]).click(function(){if($(this).hasClass('disabled'))return false;var isValid=$("#"+devName+"ResError").is(":hidden");if(isValid){$(devIDs[1]).click();$(msgIDs[0]).hide();$(msgIDs[2]).hide();$(devIDs[2]).css({backgroundColor:'#73D44C'});$(devIDs[3]).show();if($(devIDs[5]).is(":hidden")){$(devIDs[6]).fadeIn();}else{$(devIDs[6]).fadeOut();}
$(devIDs[4]).fadeTo(600,0);$(devIDs[7]).addClass("checkmark");$(devIDs[0]).addClass("disabled");saveForm(devName,function(){$(devIDs[2]).animate({backgroundColor:'#F3F2EF'},3000);$(devIDs[3]).fadeOut(3000);$(devIDs[4]).fadeTo(3000,1);$(devIDs[7]).delay(1200).fadeOut(200).queue(function(next){$(this).removeClass("checkmark");next()}).fadeIn(600);});}
return false;});$(devIDs[0]).addClass('disabled');};function addHandlers(devName){addShowDetailsHandler(devName);addReserveButttonHandler(devName);addSaveButtonHandler(devName);$("#"+devName+"_caret").rotate(180);}
function getDeviceState(id){if(id)return $('form[name='+id+']').serialize();var settings=[];for(var x in DEVS){settings[x]=$('form[name='+x+']').serialize();}
return settings;}
var originalSettings;function showWait(f){if(f==1){if(offdevlist!=devs_lst)
$('#recent').slideDown();$('#PICLoadingImg').slideUp("slow");$('#pa200t001').slideUp();$('#pa200a005').fadeIn();}else{$('#recent').hide();$('#PICLoadingImg').slideDown("slow");$('#pa200t001').slideDown();$('#pa200a005').fadeOut();}}
function init(){$('#pa200a005').click(refresh);originalSettings=getDeviceState();$(window).bind('beforeunload',function(){for(var x in originalSettings)
{if(originalSettings[x]!=getDeviceState(x))
var isChanged=true;}
if(isChanged){return getLangM('gtSettingsNotSaved');}else{return;}});ShowNavMenu();do_PC_scan();}
function refresh(){do_PC_scan();return false;}
function checkIP(devName){var f=document.forms[devName];var res_ip=$('#'+devName+'_IP_Fixed').html()+f.IP_ReserveInput.value;if(!isValidIP(res_ip))return-1;if((IP2long(res_ip)&IP2long(getCfg('lan_mask')))!=(IP2long(getCfg('lan_ip'))&IP2long(getCfg('lan_mask'))))
return-1;if(res_ip==getCfg('lan_ip'))return-1;for(var x in DEVS){dev_debug(x);if(x==devName)continue;var DEV=DEVS[x];dev_debug(DEV.ip);if((DEV.ip==res_ip)&&(DEV.isReserv==1))return x;else if((DEV.ip==res_ip)&&(DEV.isStatic==1))return x;}
return 0;}
function saveForm(devName,_cb){var f=document.forms[devName];var DEV=DEVS[devName];var res_ip=$('#'+devName+'_IP_Fixed').html()+f.IP_ReserveInput.value;var cmd="DHCPD_CONF";DEV.host=f.NameInput.value;if($("#"+devName+"_IP_ReserveInput").is(":hidden")){DEV.res_ip=res_ip;DEV.isReserv=1;}else
DEV.isReserv=0;set_DEVM(DEV);return subForm({frm:f,cmd:cmd,wait:3,wizard:1,done:function(){CloseModalURL();sycnDev(devName,_cb);}});}
var devs_list=[];var devs_lst=0;var offdevlist;var devs_last_chk=0;var scan_done=0;function get_Scan_PC(){$.getScript("cgi/cgi_pc_scan.js").done(function(script,textStatus){var sz=cgi_devs_chk_list.length-1;var mac,pc,ip,err;if(sz>devs_last_chk)
{for(var i=devs_lst;i<=sz;i++){if(cgi_devs_chk_list[i]){if(cgi_devs_chk_list[i][0]=="DONE"){if(scan_done==2){scan_done=3;}
break;}
ip=HTML2str(cgi_devs_chk_list[i][0]);var pc=findArpByIP(ip);if(pc&&!pc_alive[ip])
{addDevice("On",pc);pc_alive[ip]=pc.mac;devs_lst++;}}
devs_last_chk=i;}}
if(scan_done==3){scan_done++;SCAN_Ready();return;}
setTimeout("check_SCAN_ready()",800);}).fail(function(jqxhr,settings,exception){setTimeout("check_SCAN_ready()",800);});}
function findArpByIP(ip){var pc;var pcs=0;if(!ARPentry)return false;while((pc=ARPentry(pcs++))){if(pc.mac=="")continue;if(pc.ifna!="br0")continue;if(ip!=pc.ip)continue;return pc;}
return null;}
var pcs_done=-1;var arp_done=-1;function check_SCAN_ready(){if(scan_done>=3)return false;if(scan_done==1){scan_done=2;pcs_done=-1;arp_done=-1;cgi_arp_list=[];cgi_dhcp_list=[];cgi_devs_chk_list=[];}
if(scan_done<2)return setTimeout("check_SCAN_ready()",1000);if(pcs_done==1&&arp_done==1){setTimeout("get_Scan_PC()",1000);}
if(pcs_done<0){pcs_done=0;$.getScript("cgi/cgi_pcs.js").done(function(script,textStatus){pcs_done=1;setTimeout("check_SCAN_ready()",1000);}).fail(function(jqxhr,settings,exception){pcs_done=-1;setTimeout("check_SCAN_ready()",1000);});}
if(arp_done<0){arp_done=0;$.getScript("cgi/cgi_arp.js").done(function(script,textStatus){arp_done=1;setTimeout("check_SCAN_ready()",1000);}).fail(function(jqxhr,settings,exception){arp_done=-1;setTimeout("check_SCAN_ready()",1000);});}}
function get_ICMPScan(){$.getScript("cgi/cgi_devs.js").done(function(script,textStatus){var sz=cgi_devs_list.length-1;for(var i=0;i<=sz;i++)
{if(cgi_devs_list[i]&&cgi_devs_list[i+1])
{if(cgi_devs_list[i][1]==cgi_devs_list[i+1][1])
cgi_devs_list.splice(i+1,1);}}
scan_done=1;}).fail(function(jqxhr,settings,exception){scan_done=1;});}
function SCAN_Ready(){Show_Off_PC();originalSettings=getDeviceState();showWait(1);}
function do_PC_scan(){var scan_begin=200;pc_alive=[];devs_last_chk=0;scan_done=0;clearDevice();DEVS=[];showWait(0);devs_lst=0;setTimeout("get_ICMPScan()",scan_begin);setTimeout("check_SCAN_ready()",1000);}
function addDevice(onoff,pc)
{var list=$('ul.PIC%dNet'.replace(/%d/,onoff));var num=list.children('li.ConnDevEntry').length;var devId=onoff+(num+1);var ob=$('<li class="ConnDevEntry"><form class="nice" id="%s" name="%s"></form></li>'.replace(/%s/g,devId)).appendTo(list);var htm=$('#dev_template').html().replace(/%d/g,devId);var devTab=$('#'+devId).html(htm);devTab.hide().slideDown();addHandlers(devId);setForm(devId,pc);}
var fix_num=checkMsk();var re=new RegExp('(\\d*\\.){'+fix_num+'}');function setForm(devId,pc){var isOff=/Off/.test(devId);var DEV;DEV=findDEVByMac(pc.mac,pc.host);DEV.dev_id=devId;DEV.isStatic=isOff?0:(searh_DHCP(pc.mac)?0:1);if(DEV.hostlabel=='')DEV.hostlabel=getLangM('PIC_S1t012');if(DEV.manuf=='')DEV.manuf=getLangM('gtUnknownManu');DEV.ip=pc.ip;dev_debug(DEV.res_ip);if(!DEV.isReserv||DEV.res_ip==0)DEV.res_ip=DEV.ip;var ip=DEV.ip.split('.');var fix_ip=DEV.ip.match(re)[0];var cur_ip=DEV.ip.replace(re,'');var res_ip=DEV.res_ip.replace(re,'');$.each(devType,function(i,n){$('#'+devId+'_Icon').removeClass(n);});$('#'+devId+'_Icon').addClass(type2Str(DEV.type));$('#'+devId+'Name').text(DEV.hostlabel);$('#'+devId+'NameInput').val(DEV.host);$('#'+devId+'_Line2').html(fix_ip+'<b>'+res_ip+'</b>');$('#'+devId+'_IP_Fixed').html(fix_ip);$('#'+devId+'_IP_Reserve').html(res_ip);var inputsize=(4-fix_num)*4-1;$('#'+devId+'_IP_ReserveInput').val(cur_ip).attr({size:inputsize,maxlength:inputsize});$('#'+devId+'_MAC').html(DEV.mac);if(!DEV.isReserv||DEV.isStatic==1)
$('#'+devId+'_locked').hide();if(DEV.isStatic==1){$('#'+devId+'_ReserveToggle').hide();ReadOnly(devId+'_IP_ReserveInput')}
var msgIDs=["#"+devId+"_SaveMe","#"+devId+"_ReconnectMe","#"+devId+"_SaveMeUnreserve",'#'+devId+'_ReconnectMeDetails'];$(msgIDs.join(',')).hide();dev_debug("is coming !!!");dev_debug(DEV.isReserv);dev_debug(DEV.ip);dev_debug(DEV.res_ip);if(DEV.isReserv&&DEV.ip!=DEV.res_ip){if(!isOff){$(msgIDs[1]+','+msgIDs[3]).html(getLangM('pa200t006').replace('{{REPLACE WITH RESERVED ADDRESS}}',DEV.res_ip).replace('{{REPLACE WITH DEVICE NAME}}',DEV.hostlabel).replace('{{REPLACE WITH CURRENT ADDRESS}}',DEV.ip)).show()}}
DEVS[devId]=DEV;}
function clearDevice(){$('ul.PICOnNet,ul.PICOffNet').empty();}
function checkMsk(){var msk=getCfg('lan_mask').split('.');var i;for(i=0;msk[i]=='255';i++);return i;}
function Show_Off_PC(){offdevlist=devs_lst;for(var i=1;i<=MAX_DEV_NUM;i++){dev=get_DEV(i);if(!dev)break;if(dev.mac){var f=0;for(var x in pc_alive){if(pc_alive[x]==dev.mac){f=1;break;}}
if(!f){addDevice("Off",dev);devs_lst++;}}}
if(devs_lst-offdevlist>=4)
$('#recent ul.PICOffNet').addClass('scrollableNoBorder');}
function sycnDev(id,_cb){reload_cgi(["leases"],function(){$.getScript("cgi/cgi_devs.js").done(function(script,textStatus){setForm(id,DEVS[id]);originalSettings[id]=getDeviceState(id);if(_cb)setTimeout(_cb,10);})});}<%CGI_LOGIN_KEEP();%></script> <script><%CGI_INCLUDE(javascripts/main_footer.js);%></script>